/**
 * JQuery Searchable DropDown Plugin
 * 
 * @required jQuery 1.3.x
 * @author Sascha Wolski <hagman@gmx.de>
 * 
 * Based up on the AddIncSearch plugin published by Tobias Oetiker
 * http://plugins.jquery.com/project/AddIncSearch
 */
(function($){var t=register("searchable");t.defaults={maxListSize:100,maxMultiMatch:50,exactMatch:false,wildcards:true,ignoreCase:true,warnMultiMatch:"top {0} matches ...",warnNoMatch:"no matches ...",latency:200,observing:true,observingInterval:200,zIndex:"auto"};t.execute=function(f){if($.browser.msie&&parseInt(jQuery.browser.version)<7)return this;if(this.nodeName!="SELECT"||this.size>1)return this;var g=$(this);var h={index:-1,options:null};$.browser.chrome=/chrome/.test(navigator.userAgent.toLowerCase());if($.browser.chrome)$.browser.safari=false;if($.meta){f=$.extend({},options,g.data())}g.data("index",new Number(g.get(0).selectedIndex));var j=$("<div/>");var k=$("<input/>");var l=$("<select/>");var m=$("<option>"+f.warnMultiMatch.replace(/\{0\}/g,f.maxMultiMatch)+"</option>").attr("disabled","true");var n=$("<option>"+f.warnNoMatch+"</option>").attr("disabled","true");draw();g.resize(position);$(window).resize(position);reset();var o=false;$(j).mouseover(function(){o=true});$(j).mouseout(function(){o=false});$(l).mouseover(function(){o=true});$(l).mouseout(function(){o=false});k.click(function(e){if(!p){enable(e,true)}else{disable(e,true)}});k.blur(function(e){if(!o)disable(e,true)});g.keydown(function(e){if(e.keyCode!=9)enable(e,false,true)});g.click(function(e){l.focus()});l.click(function(e){if(l.get(0).selectedIndex<0)return;synchronize();disable(e)});l.focus(function(e){k.focus()});l.blur(function(e){if(!o)disable(e,true)});l.mousemove(function(e){if($.browser.opera&&parseFloat(jQuery.browser.version)>=9.8)return true;var a=Math.floor(parseFloat(/([0-9\.]+)px/.exec($(l.get(0).options[0]).css("font-size"))));var b=4;if($.browser.opera)b=2.5;if($.browser.safari||$.browser.chrome)b=3;a+=Math.round(a/b);l.get(0).selectedIndex=Math.floor((e.pageY-this.offsetTop+this.scrollTop)/a)});var p=false;j.click(function(e){if(!p){enable(e,true)}else{disable(e,true)}});k.keyup(function(e){if(jQuery.inArray(e.keyCode,new Array(9,13,16,33,34,35,36,38,40))>-1)return true;s=$.trim(k.val().toLowerCase());if(q!=null)clearTimeout(q);q=setTimeout(searching,f.latency)});k.keydown(function(e){if(e.shiftKey||e.ctrlKey||e.altKey)return;switch(e.keyCode){case 9:disable(e);moveTab(g,e.shiftKey?-1:1);break;case 13:disable(e);g.focus();break;case 27:disable(e,true);g.focus();break;case 33:if(l.get(0).selectedIndex-l.get(0).size>0){l.get(0).selectedIndex-=l.get(0).size}else{l.get(0).selectedIndex=0}synchronize();break;case 34:if(l.get(0).selectedIndex+l.get(0).size<l.get(0).options.length-1){l.get(0).selectedIndex+=l.get(0).size}else{l.get(0).selectedIndex=l.get(0).options.length-1}synchronize();break;case 38:if(l.get(0).selectedIndex>0){l.get(0).selectedIndex--;synchronize()}break;case 40:if(l.get(0).selectedIndex<l.get(0).options.length-1){l.get(0).selectedIndex++;synchronize()}break;default:return true}return false});function enable(e,a,v){if(g.attr("disabled"))return false;if(typeof v=="undefined")p=!p;synchronize();store();var b=g.find(":selected");g.data("text",b.text());b.text("");k.show();k.focus();k.select();if(a)l.show();if(typeof e!="undefined")e.stopPropagation()};function disable(e,a){p=false;if(q!=null)clearTimeout(q);g.find(":selected").text(g.data("text"));k.hide();l.hide();if(typeof a!="undefined")restore();if(typeof a=="undefined")populate();if(typeof e!="undefined")e.stopPropagation()};function draw(){g.data("display",g.css("display"));g.css("display","block");g.parents().each(function(){$(this).data("display",$(this).css("display"));$(this).css("display","block")});g.css("text-decoration","none");g.width(g.outerWidth());g.height(g.outerHeight());j.css({"position":"absolute","width":g.outerWidth(),"height":g.outerHeight(),"background-color":"#FFFFFF","opacity":"0.01"});k.attr("type","text");k.hide();k.height(g.outerHeight());k.css({"position":"absolute","margin":0,"padding":0,"outline-style":"none","border-style":"solid","border-bottom-style":"none","border-color":"transparent","background-color":"transparent"});var a=new Array();a.push("border-left-width");a.push("border-top-width");a.push("font-size");a.push("font-stretch");a.push("font-variant");a.push("font-weight");a.push("color");a.push("text-align");a.push("text-indent");a.push("text-shadow");a.push("text-transform");a.push("padding-left");a.push("padding-top");for(var i=0;i<a.length;i++)k.css(a[i],g.css(a[i]));if($.browser.msie&&parseInt(jQuery.browser.version)<8){k.css("padding","0px");k.css("padding-left","3px");k.css("border-left-width","2px");k.css("border-top-width","3px")}else if($.browser.chrome){k.height(g.innerHeight());k.css("text-transform","none");k.css("padding-left",parseFloatPx(k.css("padding-left"))+3);k.css("padding-top",2)}else if($.browser.safari){k.height(g.innerHeight());k.css("padding-top",2);k.css("padding-left",3);k.css("text-transform","none")}else if($.browser.opera){k.height(g.innerHeight());var b=parseFloatPx(g.css("padding-left"));k.css("padding-left",b==1?b+1:b);k.css("padding-top",0)}else{k.css("padding-left",parseFloatPx(g.css("padding-left"))+3);k.css("padding-top",parseFloatPx(g.css("padding-top"))+1)}var c=parseFloatPx(g.css("padding-left"))+parseFloatPx(g.css("padding-right"))+parseFloatPx(g.css("border-left-width"))+parseFloatPx(g.css("border-left-width"))+23;k.width(g.outerWidth()-c);var w=g.css("width");var d=g.outerWidth();g.css("width","auto");var d=d>g.outerWidth()?d:g.outerWidth();g.css("width",w);l.attr("size",Math.min(g.get(0).length,20));l.hide();l.css({"position":"absolute","width":d,"border":"1px solid #333","font-weight":"normal","padding":0,"background-color":g.css("background-color"),"text-transform":g.css("text-transform")});var e=/^\d+$/.test(g.css("z-index"))?g.css("z-index"):1;if(f.zIndex&&/^\d+$/.test(f.zIndex))e=f.zIndex;j.css("z-index",(e).toString(10));k.css("z-index",(e+1).toString(10));l.css("z-index",(e+2).toString(10));position();g.css("display",g.data("display"));g.parents().each(function(){$(this).css("display",$(this).data("display"))});g.after(j);g.after(k);g.after(l)}function position(){var a=g.offset();j.css({top:a.top,left:a.left});k.css({top:a.top,left:a.left});l.css({top:a.top+g.outerHeight(),left:a.left})};function populate(){observing=false;if(l.get(0).selectedIndex<0||l.get(0).options[l.get(0).selectedIndex].disabled){observing=true;return}g.get(0).selectedIndex=parseInt($(l.get(0).options[l.get(0).selectedIndex]).attr("lang"));g.change();g.data("index",new Number(g.get(0).selectedIndex));observing=true};function synchronize(){if(g.get(0).selectedIndex!=g.data("index")){g.data("index",new Number(g.get(0).selectedIndex));reset()}if(l.get(0).selectedIndex>-1&&!l.get(0).options[l.get(0).selectedIndex].disabled)k.val(g.get(0).options[parseInt($(l.get(0).options[l.get(0).selectedIndex]).attr("lang"))].text);else k.val(g.get(0).options[g.get(0).selectedIndex].text)};function store(){h.index=l.get(0).selectedIndex;h.options=new Array();for(var i=0;i<l.get(0).options.length;i++)h.options.push(l.get(0).options[i])};function restore(){l.empty();l.attr("size",Math.max(2,Math.min(h.options.length,20)));for(var i=0;i<h.options.length;i++)l.append(h.options[i]);l.get(0).selectedIndex=h.index};function reset(){var a=Math.floor(f.maxMultiMatch/2);var b=Math.max(0,(g.get(0).selectedIndex-a));var c=Math.min(g.get(0).length,Math.max(f.maxMultiMatch,(g.get(0).selectedIndex+a)));var d=g.get(0).selectedIndex-b;l.empty();for(var i=b;i<c;i++)l.append($(g.get(0).options[i]).clone().attr("lang",i));if(g.get(0).length>f.maxMultiMatch)l.append(m);l.get(0).selectedIndex=d};function moveTab(a,b){var c=a.parents("form,body").eq(0).find("button,input[type!=hidden],textarea,select");var d=c.index(a);if(d>-1&&d+b<c.length&&d+b>=0){c.eq(d+b).focus();return true}return false};function escapeRegExp(a){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\","^","$"];var c=new RegExp("(\\"+b.join("|\\")+")","g");return a.replace(c,"\\$1")};var q=null;var r;var s;function searching(){if(r==s){q=null;return}var a=0;r=s;l.hide();l.empty();var b=escapeRegExp(s);if(f.exactMatch)b="^"+b;if(f.wildcards){b=b.replace(/\\\*/g,".*");b=b.replace(/\\\?/g,".")}var c;if(f.ignoreCase)c="i";s=new RegExp(b,c);for(var i=0;i<g.get(0).length&&a<f.maxMultiMatch;i++){if(s.length==0||s.test(g.get(0).options[i].text)){var d=$(g.get(0).options[i]).clone().attr("lang",i);if(g.data("index")==i)d.text(g.data("text"));l.append(d);a++}}if(a>=1){l.get(0).selectedIndex=0}else if(a==0){l.append(n)}if(a>=f.maxMultiMatch){l.append(m)}l.attr("size",Math.max(2,Math.min(a,20)));l.show();q=null};function parseFloatPx(a){try{a=parseFloat(a.replace(/[\s]*px/,""));if(!isNaN(a))return a}catch(e){}return 0};return};function register(b){var c=$[b]={};$.fn[b]=function(a){a=$.extend(c.defaults,a);return this.each(function(){c.execute.call(this,a)})};return c}})(jQuery);